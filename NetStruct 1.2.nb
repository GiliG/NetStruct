(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    151515,       3549]
NotebookOptionsPosition[    151009,       3527]
NotebookOutlinePosition[    151353,       3542]
CellTagsIndexPosition[    151310,       3539]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["NetStruct", "Title",
 CellChangeTimes->{{3.6465590541751337`*^9, 3.6465590569002895`*^9}}],

Cell["\<\
INSTRUCTIONS:

To run a cell click anywhere in the cell and then hit Shift+Enter

In order to run NetStruct:
   1. Run the initialization cell  (the green cell) 
   2. Run the NetStruct cell (the orange cell)  and follow instruction therein

Once the program terminates, the requested output files will be available at \
the specified folder \
\>", "Text",
 CellChangeTimes->{{3.6462775625480733`*^9, 3.6462775628340893`*^9}, {
   3.6462776009262686`*^9, 3.646277839655923*^9}, {3.646277912122068*^9, 
   3.646278025084529*^9}, {3.6462780856229916`*^9, 3.6462780997427993`*^9}, {
   3.646278150316692*^9, 3.6462781794563584`*^9}, {3.646285863416856*^9, 
   3.646285907498377*^9}, {3.646285953163989*^9, 3.6462859570182095`*^9}, {
   3.6462860760640182`*^9, 3.646286101733487*^9}, {3.6462861563796124`*^9, 
   3.6462862259155893`*^9}, {3.6462869012482166`*^9, 
   3.6462869032563314`*^9}, {3.6462989255779686`*^9, 
   3.6462990622807875`*^9}, {3.6462993082138543`*^9, 3.646299309066903*^9}, {
   3.6462994280717096`*^9, 3.6462994588704715`*^9}, {3.646299710576868*^9, 
   3.646299721429489*^9}, {3.646453468071891*^9, 3.64645354376422*^9}, {
   3.646453588926803*^9, 3.646453622365716*^9}, {3.6464604330792665`*^9, 
   3.6464604674212303`*^9}, 3.6464791961849546`*^9, {3.6465590668238573`*^9, 
   3.6465590707630825`*^9}, {3.6465591258562336`*^9, 3.64655915253576*^9}}],

Cell[BoxData[
 RowBox[{"NetStruct", "[", "]"}]], "Input",
 CellChangeTimes->{3.6464533035164785`*^9},
 Background->RGBColor[1, 0.9, 0.8]],

Cell[CellGroupData[{

Cell["Initialization cell", "Subtitle",
 CellChangeTimes->{{3.6465590974506087`*^9, 3.646559101803858*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$HistoryLength", "=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyThreshold", "[", 
    RowBox[{"matx_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", "<", "threshold"}], ",", "0", ",", "#"}], "]"}], "&"}], 
      ",", "matx", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BreakToComponents", "[", 
    RowBox[{"matx_", ",", "indlistInfo_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Given", " ", "a", " ", "GD", " ", "matrix", " ", "and", " ", 
      "threshold"}], ",", 
     RowBox[{
     "breaks", " ", "the", " ", "networks", " ", "into", " ", "connected", 
      " ", 
      RowBox[{"componenets", ".", " ", "Returns"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "A", " ", "list", " ", "of", " ", "matrices", " ", "of", " ", "the", 
         " ", "components"}], ",", " ", 
        RowBox[{
        "A", " ", "list", " ", "of", " ", "reordered", " ", "indlists", " ", 
         "of", " ", "the", " ", "matrices"}], ",", " ", 
        RowBox[{
        "GD", " ", "mathrix", " ", "with", " ", "the", " ", "threshold", " ", 
         "applied"}]}], " ", "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m1", ",", "g", ",", "complist", ",", "m2", ",", "indlistnew"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"m1", "=", 
       RowBox[{"ApplyThreshold", "[", 
        RowBox[{"matx", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"WeightedAdjacencyGraph", "[", 
        RowBox[{"m1", "/.", " ", 
         RowBox[{"0", "\[Rule]", "\[Infinity]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"complist", "=", 
       RowBox[{"ConnectedComponents", "[", "g", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"m1", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{
           "complist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
            ",", 
           RowBox[{
           "complist", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "complist", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"indlistnew", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"indlistInfo", "\[LeftDoubleBracket]", 
          RowBox[{
          "complist", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "complist", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"m2", ",", "indlistnew", ",", "m1"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<RLink`\>\"", "]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "These", " ", "lines", " ", "initiate", " ", "Rlink", " ", "and", " ", 
    "the", " ", "igraph", " ", "package"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InstallR", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RLinkResourcesInstall", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"REvaluate", "[", "\"\<require('igraph')\>\"", "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "\[Equal]", 
     "False"}], ",", 
    RowBox[{"REvaluate", "[", "\"\<install.packages('igraph')\>\"", "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"REvaluate", "[", "\"\<library(igraph)\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindCommunitiesIgraphPlusModularity", "[", 
    RowBox[{"matx_", ",", "Algorithim_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Given", " ", "a", " ", "matrix", " ", "and", " ", "iGraph", " ", 
      "algorithim", " ", "name", " ", 
      RowBox[{"(", 
       RowBox[{"from", " ", "list", " ", "below"}], ")"}]}], ",", " ", 
     RowBox[{"returns", " ", 
      RowBox[{"{", 
       RowBox[{"modularity", ",", " ", 
        RowBox[{"list", " ", "of", " ", "communities"}], ",", " ", 
        RowBox[{"list", " ", "of", " ", 
         RowBox[{"individual", "'"}], "s", " ", "assignment", " ", "to", " ", 
         "communities"}]}], "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "com", ",", "matrixlist", ",", "V", ",", "line1", ",", "line2", ",", 
       "line3", ",", "line4", ",", "Rcode"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "matx", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"com", "=", 
         RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"matrixlist", "=", 
          RowBox[{"Flatten", "[", "matx", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"V", "=", 
          RowBox[{"Length", "[", "matx", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"line1", "=", 
          RowBox[{"\"\<mat<-matrix(c(\>\"", "<>", 
           RowBox[{"StringDrop", "[", 
            RowBox[{
             RowBox[{"StringDrop", "[", 
              RowBox[{
               RowBox[{"ToString", "[", "matrixlist", "]"}], ",", "1"}], 
              "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], "<>", "\"\<), nrow = \>\"", "<>", 
           RowBox[{"ToString", "[", "V", "]"}], "<>", "\"\<, ncol = \>\"", "<>", 
           RowBox[{"ToString", "[", "V", "]"}], "<>", "\"\<)\n\>\""}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
         "line2", "=", 
          "\"\<g<-graph.adjacency(mat, mode=\\\"undirected\\\", \
weighted=TRUE)\n\>\""}], ";", "\[IndentingNewLine]", 
         RowBox[{"line3", "=", 
          RowBox[{
          "\"\<Communities<-\>\"", "<>", "Algorithim", "<>", 
           "\"\<(g)\n\>\""}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
         "line4", "=", 
          "\"\<list( membership(Communities), modularity(Communities))\>\""}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Rcode", "=", 
          RowBox[{
          "\"\<{\>\"", "<>", "line1", "<>", "\[IndentingNewLine]", "line2", "<>",
            "\[IndentingNewLine]", "line3", "<>", "\[IndentingNewLine]", 
           "line4", "<>", "\"\<}\>\""}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"com", "=", 
          RowBox[{"REvaluate", "[", "Rcode", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"com", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
           "com", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "com"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AlgorithimList", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<label.propagation.community\>\"", ",", 
      "\"\<edge.betweenness.community\>\"", ",", 
      "\"\<fastgreedy.community\>\"", ",", "\"\<walktrap.community\>\"", ",", 
      "\"\<spinglass.community\>\"", ",", 
      "\"\<leading.eigenvector.community\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CommunityDetection", "[", 
    RowBox[{
    "mx_", ",", "threshold_", ",", "algorithim_", ",", "indlistInfo_"}], 
    "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Return", " ", "list", " ", "of", " ", 
     RowBox[{"individual", "'"}], "s", " ", "data", " ", "as", " ", 
     RowBox[{"output", ":", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sampled", " ", "pop"}], ",", " ", 
        RowBox[{"ind", " ", "name"}], ",", " ", 
        RowBox[{"assigned", " ", "community", " ", "number"}]}], "}"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "bc", ",", "fc", ",", "indcomlist", ",", "count", ",", "indcomt"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bc", "=", 
       RowBox[{"BreakToComponents", "[", 
        RowBox[{"mx", ",", "indlistInfo", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fc", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"FindCommunitiesIgraphPlusModularity", "[", 
          RowBox[{
           RowBox[{"bc", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "AlgorithimList", "\[LeftDoubleBracket]", "algorithim", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "bc", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indcomlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"indcomt", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"bc", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "i", ",", "j"}], "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
               RowBox[{"fc", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "+", 
               "count"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", 
               RowBox[{
               "fc", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "]"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"indcomlist", ",", "indcomt"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"count", "=", 
          RowBox[{"count", "+", 
           RowBox[{"Max", "[", 
            RowBox[{
            "fc", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}]}]}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "fc", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Join", "@@", "indcomlist"}], ",", " ", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"indlistInfo", ",", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
         "&"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColorFunc", "[", 
    RowBox[{"ind_", ",", "ComDetResult_", ",", "colors_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "com", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"com", "=", 
       RowBox[{"ComDetResult", "\[LeftDoubleBracket]", 
        RowBox[{"ind", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
      "colors", "\[LeftDoubleBracket]", "com", "\[RightDoubleBracket]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotNetwork", "[", 
    RowBox[{
    "GDmatrix_", ",", "threshold_", ",", "ComDetResult_", ",", "colors_"}], 
    "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "Gives", " ", "a", " ", "plot", " ", "of", " ", "the", " ", "network", 
     " ", "with", " ", "node", " ", "colors", " ", "corresponding", " ", "to",
      " ", "assigned", " ", "communities"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"matrix", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"matrix", "=", 
       RowBox[{"ApplyThreshold", "[", 
        RowBox[{"GDmatrix", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"WeightedAdjacencyGraph", "[", 
        RowBox[{
         RowBox[{"matrix", "/.", " ", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Lighter", "[", 
           RowBox[{"Black", ",", "0.8"}], "]"}]}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"ColorFunc", "[", 
              RowBox[{"i", ",", "ComDetResult", ",", "colors"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ComDetResult", "]"}]}], "}"}]}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "g"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotNetworkCoordinates", "[", 
    RowBox[{
    "GDmatrix_", ",", "threshold_", ",", "ComDetResult_", ",", 
     "PopCoordinates_", ",", "proximity_", ",", "colors_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Gives", " ", "a", " ", "plot", " ", "of", " ", "the", " ", "network", 
       " ", "with", " ", "node", " ", "colors", " ", "corresponding", " ", 
       "to", " ", "assigned", " ", 
       RowBox[{"communities", ".", " ", "Nodes"}], " ", "are", " ", 
       "positioned", " ", "at"}], " ", "\[PlusMinus]", 
      RowBox[{"proximity", " ", 
       RowBox[{"(", 
        RowBox[{
        "defined", " ", "by", " ", "the", " ", "parameter", " ", 
         "proximity"}], ")"}], " ", "of", " ", "the", " ", "corrdinate", " ", 
       "given", " ", "for", " ", "the", " ", "sampled", " ", "population", 
       " ", "\[IndentingNewLine]", "PopCoordinates"}]}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pop1name", ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["y", "1"]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"pop2name", ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["x", "1"], ",", 
           SubscriptBox["y", "1"]}], "}"}]}], "}"}], ",", 
       RowBox[{"...", 
        RowBox[{"{", 
         RowBox[{"popkname", ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["x", "k"], ",", 
            SubscriptBox["y", "k"]}], "}"}]}], "}"}]}]}], "}"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"matrix", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"matrix", "=", 
       RowBox[{"ApplyThreshold", "[", 
        RowBox[{"GDmatrix", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"WeightedAdjacencyGraph", "[", 
        RowBox[{
         RowBox[{"matrix", "/.", " ", 
          RowBox[{"0", "\[Rule]", "\[Infinity]"}]}], ",", 
         RowBox[{"EdgeStyle", "\[Rule]", 
          RowBox[{"Lighter", "[", 
           RowBox[{"Black", ",", "0.8"}], "]"}]}], ",", 
         RowBox[{"VertexStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[Rule]", 
             RowBox[{"ColorFunc", "[", 
              RowBox[{"i", ",", "ComDetResult", ",", "colors"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ComDetResult", "]"}]}], "}"}]}], 
           "]"}]}], ",", 
         RowBox[{"VertexCoordinates", "\[Rule]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Select", "[", 
               RowBox[{"PopCoordinates", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "\[Equal]", 
                  RowBox[{"ComDetResult", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                 "&"}]}], "]"}], "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "proximity"}], ",", "proximity"}], "}"}], 
                "]"}], ",", 
               RowBox[{"RandomReal", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "proximity"}], ",", "proximity"}], "}"}], 
                "]"}]}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "ComDetResult", "]"}]}], "}"}]}], 
           "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "g"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Qmodularity", "[", 
    RowBox[{"Aij_", ",", "comunities_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{"Weighted", " ", "modularity"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TotalWieght", ",", "degrees", ",", "q"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TotalWieght", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", "Aij", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"degrees", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
          "Aij", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "Aij", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "comunities", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"q", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "comunities", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "==", 
                  RowBox[{
                  "comunities", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{"q", "=", 
                  RowBox[{"q", "+", 
                   RowBox[{"Aij", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "-", 
                   FractionBox[
                    RowBox[{
                    RowBox[{
                    "degrees", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{
                    "degrees", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "TotalWieght"]}]}]}], "]"}], 
               ";"}], "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"Length", "[", "Aij", "]"}]}], "}"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "Aij", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "q", "]"}], "<", "0.00001"}], ",", 
           RowBox[{"q", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"q", "=", 
          RowBox[{"N", "[", 
           FractionBox["q", "TotalWieght"], "]"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "q"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataCheckGDmatrix", "[", "GDmatrix_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DataOKQ1", ",", "DataOKQ2", ",", "DataOKQ3", ",", "errorlines", ",", 
       "DataOK"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DataOKQ1", "=", "False"}], ";", 
      RowBox[{"DataOKQ2", "=", "False"}], ";", 
      RowBox[{"DataOKQ3", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"errorlines", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<The GDmatrix file is not \>\"", ",", "\"\<\>\""}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<in the correct format:\>\"", ",", "\"\<\>\""}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatrixQ", "[", 
         RowBox[{"GDmatrix", ",", "NumberQ"}], "]"}], ",", 
        RowBox[{"DataOKQ1", "=", "True"}], ",", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"errorlines", ",", 
          RowBox[{"{", "\"\<Not a numerical matrix\>\"", "}"}]}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Diagonal", "[", "GDmatrix", "]"}], "]"}], "\[Equal]", 
         RowBox[{"{", "0", "}"}]}], ",", 
        RowBox[{"DataOKQ2", "=", "True"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"DataOKQ1", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"errorlines", ",", 
            RowBox[{"{", "\"\<GDmatrix diagonal is not 0\>\"", "}"}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SymmetricMatrixQ", "[", "GDmatrix", "]"}], ",", 
        RowBox[{"DataOKQ3", "=", "True"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{"DataOKQ1", ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"errorlines", ",", 
            RowBox[{"{", "\"\<GDMatrix is not symmetric\>\"", "}"}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"DataOK", "=", 
       RowBox[{"DataOKQ1", "&&", "DataOKQ2", "&&", "DataOKQ3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"DataOK", ",", "errorlines"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataCheckIndlistInfo", "[", "IndlistInfo_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "DataOKQ1", ",", "DataOKQ2", ",", "errorlines", ",", "DataOK"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DataOKQ1", "=", "False"}], ";", 
       RowBox[{"DataOKQ2", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"errorlines", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<The IndlistInfo file is not \>\"", ",", "\"\<\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<in the correct format:\>\"", ",", "\"\<\>\""}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Dimensions", "[", "IndlistInfo", "]"}], "]"}], "\[Equal]",
           "2"}], ",", 
         RowBox[{"DataOKQ1", "=", "True"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"errorlines", ",", 
           RowBox[{
           "{", "\"\<IndlistInfo file does not contain a table\>\"", "}"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "IndlistInfo", "]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "\[Equal]",
           "2"}], ",", 
         RowBox[{"DataOKQ2", "=", "True"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"errorlines", ",", 
           RowBox[{"{", "\"\<Table not formatted correctly\>\"", "}"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"DataOK", "=", 
        RowBox[{"DataOKQ1", "&&", "DataOKQ2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"DataOK", ",", "errorlines"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DataCheckPopcords", "[", 
     RowBox[{"popcordlist_", ",", "IndlistInfo_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "DataOKQ1", ",", "DataOKQ2", ",", "DataOKQ3", ",", "errorlines", ",", 
        "Npops", ",", "DataOKQ"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"DataOKQ1", "=", "False"}], ";", 
       RowBox[{"DataOKQ2", "=", "False"}], ";", 
       RowBox[{"DataOKQ3", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"errorlines", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<The PopCoord file is not \>\"", ",", "\"\<\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<in the correct format:\>\"", ",", "\"\<\>\""}], "}"}],
           ",", 
          RowBox[{"{", 
           RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Npops", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"IndlistInfo", ",", "All", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Dimensions", "[", "popcordlist", "]"}], "]"}], "\[Equal]",
           "2"}], ",", 
         RowBox[{"DataOKQ1", "=", "True"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"errorlines", ",", 
           RowBox[{"{", "\"\<File does not contain a table\>\"", "}"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "popcordlist", "]"}], 
           "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "\[Equal]",
           "3"}], ",", 
         RowBox[{"DataOKQ2", "=", "True"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"DataOKQ1", ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{
             "{", "\"\<Table does not contain 3 coloumns\>\"", "}"}]}], 
            "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "popcordlist", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           "1"}], "\[Equal]", "Npops"}], ",", 
         RowBox[{"DataOKQ3", "=", "True"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{"DataOKQ1", ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{
             "{", "\"\<Number of rows in coloumns does not match number of \
populations in the Indlist file\>\"", "}"}]}], "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DataOKQ", "=", 
        RowBox[{"DataOKQ1", "&&", "DataOKQ2", "&&", "DataOKQ3"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"DataOKQ", ",", "errorlines"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunCommunityDetection", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "GDmatrixfilename", ",", "IndlistInfofilename", ",", "GDmatrix", ",", 
       "IndlistInfo", ",", "algorithim", ",", "threshold", ",", 
       "thresholdmin", ",", "thresholdmax", ",", "thresholdjump", ",", 
       "comdet", ",", "plotQ", ",", "algname", ",", "Ncom", ",", "colors", 
       ",", "plot1", ",", "poplistfileQ", ",", "popcordlistfilename", ",", 
       "popcordlist", ",", "prox", ",", "sampledPops", ",", "plot2", ",", 
       "SADQ", ",", "GDmatrixcheck", ",", "IndlistInfocheck", ",", 
       "Popcordcheck"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"continuefeomcontructQ", "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"GDmatrixfilename", "=", 
          RowBox[{"SystemDialogInput", "[", 
           RowBox[{"\"\<FileOpen\>\"", ",", 
            RowBox[{
            "WindowTitle", "\[Rule]", 
             "\"\<Select Genetic-Distance matrix file\>\""}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GDmatrix", "=", 
          RowBox[{"Import", "[", "GDmatrixfilename", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GDmatrixcheck", "=", 
          RowBox[{"DataCheckGDmatrix", "[", "GDmatrix", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{
            "GDmatrixcheck", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{
            RowBox[{"DialogInput", "[", 
             RowBox[{
              RowBox[{"Grid", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{
                 "GDmatrixcheck", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "}"}],
                   "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"WindowSize", "\[Rule]", "All"}]}], "]"}], ";", 
            RowBox[{"Quit", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"IndlistInfofilename", "=", 
          RowBox[{"SystemDialogInput", "[", 
           RowBox[{"\"\<FileOpen\>\"", ",", 
            RowBox[{
            "WindowTitle", "\[Rule]", 
             "\"\<Select Individuals list file\>\""}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"IndlistInfo", "=", 
          RowBox[{"Import", "[", "IndlistInfofilename", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"IndlistInfocheck", "=", 
          RowBox[{"DataCheckIndlistInfo", "[", "IndlistInfo", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{
            "IndlistInfocheck", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", 
           RowBox[{
            RowBox[{"DialogInput", "[", 
             RowBox[{
              RowBox[{"Grid", "[", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{
                 "IndlistInfocheck", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "}"}],
                   "}"}]}], "]"}], "]"}], ",", 
              RowBox[{"WindowSize", "\[Rule]", "All"}]}], "]"}], ";", 
            RowBox[{"Quit", "[", "]"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Outputfilename", "=", 
       RowBox[{"SystemDialogInput", "[", 
        RowBox[{"\"\<FileSave\>\"", ",", 
         RowBox[{
         "WindowTitle", "\[Rule]", 
          "\"\<Select output folder and file name\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DialogInput", "[", 
       RowBox[{"Grid", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<Community detection parameters\>\"", ",", "Bold", ",", 
              "20"}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Community detection algorithim (1 to 6):\>\"", ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "inp1", "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", "\"\<   1 - Label Propagation\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<   2 - Girvan-Newman\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<   3 - Fast Greedy\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<   4 - Walktrap\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<   5 - Spinglass\>\"", "}"}], ",", 
           RowBox[{"{", "\"\<   6 - Leading Eigenvector\>\"", "}"}], ",", 
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{
              "\"\<The range of genetic distances in the genetic distance \
matrix is between \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Min", "[", "GDmatrix", "]"}], "]"}], "<>", 
               "\"\< and \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Max", "[", "GDmatrix", "]"}], "]"}]}], ",", "Bold"}],
              "]"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Genetic distance threshold below which to remove edge:\>\"", 
             ",", 
             RowBox[{"RadioButton", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "radio", "]"}], ",", "0"}], "]"}], ",",
              "\[IndentingNewLine]", "\"\<Single threshold value:\>\"", ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "inp2", "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<\>\"", ",", "\[IndentingNewLine]", 
             RowBox[{"RadioButton", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "radio", "]"}], ",", "1"}], "]"}], 
             ",", "\"\<Threshold range:\>\"", ",", "\"\<from\>\"", ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "inp3", "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], ",", 
             "\"\<to\>\"", ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "inp4", "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}], ",", 
             "\"\<in jumps of\>\"", ",", 
             RowBox[{"InputField", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "inp5", "]"}], ",", "Number", ",", 
               RowBox[{"FieldSize", "\[Rule]", "4"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Button", "[", 
             RowBox[{"\"\<OK\>\"", ",", 
              RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", ",", "Automatic"}], "}"}]}], ",", 
         RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"algorithim", "=", "inp1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"threshold", "=", "inp2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"thresholdmin", "=", "inp3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"thresholdmax", "=", "inp4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"thresholdjump", "=", "inp5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"singlevalue", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"radio", "\[Equal]", "0"}], ",", "True", ",", "False"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"singlevalue", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"comdet", "=", 
          RowBox[{"CommunityDetection", "[", 
           RowBox[{
           "GDmatrix", ",", "threshold", ",", "algorithim", ",", 
            "IndlistInfo"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"Outputfilename", "<>", "\"\<_ComAssignment.csv\>\""}], 
           ",", "comdet"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"Outputfilename", "<>", "\"\<_ComAssignment.mx\>\""}], ",",
            "comdet"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "singlevalue"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"comdet", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"CommunityDetection", "[", 
             RowBox[{
             "GDmatrix", ",", "threshold", ",", "algorithim", ",", 
              "IndlistInfo"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "threshold", ",", "thresholdmin", ",", "thresholdmax", ",", 
              "thresholdjump"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{
              "Outputfilename", "<>", "\"\<_ComAssignment_thrsh\>\"", "<>", 
               RowBox[{"ToString", "[", "threshold", "]"}], "<>", 
               "\"\<.csv\>\""}], ",", 
              RowBox[{"comdet", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"Round", "[", 
                 FractionBox[
                  RowBox[{"threshold", "-", "thresholdmin"}], 
                  "thresholdjump"], "]"}], "+", "1"}], 
               "\[RightDoubleBracket]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{
              "Outputfilename", "<>", "\"\<_ComAssignment_thrsh\>\"", "<>", 
               RowBox[{"ToString", "[", "threshold", "]"}], "<>", 
               "\"\<.mx\>\""}], ",", 
              RowBox[{"comdet", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"Round", "[", 
                 FractionBox[
                  RowBox[{"threshold", "-", "thresholdmin"}], 
                  "thresholdjump"], "]"}], "+", "1"}], 
               "\[RightDoubleBracket]"}]}], "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{
            "threshold", ",", "thresholdmin", ",", "thresholdmax", ",", 
             "thresholdjump"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"plotQ", "=", 
       RowBox[{"ChoiceDialog", "[", 
        RowBox[{
        "\"\<Community detection completed.\nWould you like image files of \
the network? \>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<          No          \>\"", "\[Rule]", "0"}], ",", 
           RowBox[{"\"\< Without coordinates \>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\< With coordinates \>\"", "\[Rule]", "2"}], ",", 
           RowBox[{
           "\"\< One with coordinates and one without \>\"", "\[Rule]", 
            "3"}]}], "}"}], ",", 
         RowBox[{"WindowSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"600", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"singlevalue", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ncom", "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"comdet", ",", "All", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"colors", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Ncom", "<", "10"}], ",", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Darker", "[", "Green", "]"}], ",", 
              RowBox[{"Lighter", "[", 
               RowBox[{"Blue", ",", "0.4"}], "]"}], ",", "Yellow", ",", 
              "Orange", ",", "Magenta", ",", "Cyan", ",", "Purple", ",", 
              "LightGreen"}], "}"}], ",", 
            RowBox[{"RandomSample", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ColorData", "[", "\"\<VisibleSpectrum\>\"", "]"}], 
                "[", "i", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "400", ",", "700", ",", 
                 RowBox[{
                  FractionBox["1", 
                   RowBox[{"Ncom", "-", "1"}]], 
                  RowBox[{"(", 
                   RowBox[{"700", "-", "400"}], ")"}]}]}], "}"}]}], "]"}], 
             "]"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", "singlevalue"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ncom", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{
               "comdet", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", "All", ",", 
               RowBox[{"{", "3", "}"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "comdet", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"colors", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "Ncom", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                "<", "10"}], ",", 
              RowBox[{"{", 
               RowBox[{"Red", ",", 
                RowBox[{"Darker", "[", "Green", "]"}], ",", 
                RowBox[{"Lighter", "[", 
                 RowBox[{"Blue", ",", "0.4"}], "]"}], ",", "Yellow", ",", 
                "Orange", ",", "Magenta", ",", "Cyan", ",", "Purple", ",", 
                "LightGreen"}], "}"}], ",", 
              RowBox[{"RandomSample", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ColorData", "[", "\"\<VisibleSpectrum\>\"", "]"}], 
                  "[", "i", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "400", ",", "700", ",", 
                   RowBox[{
                    FractionBox["1", 
                    RowBox[{
                    RowBox[{
                    "Ncom", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "-", "1"}]], 
                    RowBox[{"(", 
                    RowBox[{"700", "-", "400"}], ")"}]}]}], "}"}]}], "]"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "comdet", "]"}]}], "}"}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"plotQ", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"singlevalue", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plot1", "=", 
             RowBox[{"PlotNetwork", "[", 
              RowBox[{
              "GDmatrix", ",", "threshold", ",", "comdet", ",", "colors"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"algname", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"algorithim", "\[Equal]", "1"}], ",", 
               "\"\<Label Propagation\>\"", ",", 
               RowBox[{"algorithim", "\[Equal]", "2"}], ",", 
               "\"\<Girvan-Newman\>\"", ",", 
               RowBox[{"algorithim", "\[Equal]", "3"}], ",", 
               "\"\<Fast Greedy\>\"", ",", 
               RowBox[{"algorithim", "\[Equal]", "4"}], ",", 
               "\"\<Walktrap\>\"", ",", 
               RowBox[{"algorithim", "\[Equal]", "5"}], ",", 
               "\"\<Spinglass\>\"", ",", 
               RowBox[{"algorithim", "\[Equal]", "6"}], ",", 
               "\"\<Leading Eigenvector\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"plot1", "=", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                  "\"\<     Threshold: \>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                RowBox[{"{", "plot1", "}"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"Outputfilename", "<>", "\"\<_netfig.pdf\>\""}], ",", 
              "plot1"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "singlevalue"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"plot1", "=", 
               RowBox[{"PlotNetwork", "[", 
                RowBox[{"GDmatrix", ",", "threshold", ",", 
                 RowBox[{"comdet", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"colors", "\[LeftDoubleBracket]", 
                  RowBox[{
                   RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"algname", "=", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"algorithim", "\[Equal]", "1"}], ",", 
                 "\"\<Label Propagation\>\"", ",", 
                 RowBox[{"algorithim", "\[Equal]", "2"}], ",", 
                 "\"\<Girvan-Newman\>\"", ",", 
                 RowBox[{"algorithim", "\[Equal]", "3"}], ",", 
                 "\"\<Fast Greedy\>\"", ",", 
                 RowBox[{"algorithim", "\[Equal]", "4"}], ",", 
                 "\"\<Walktrap\>\"", ",", 
                 RowBox[{"algorithim", "\[Equal]", "5"}], ",", 
                 "\"\<Spinglass\>\"", ",", 
                 RowBox[{"algorithim", "\[Equal]", "6"}], ",", 
                 "\"\<Leading Eigenvector\>\""}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"plot1", "=", 
               RowBox[{"Grid", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                    "\"\<     Threshold: \>\"", "<>", 
                    RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                  RowBox[{"{", "plot1", "}"}]}], "}"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Export", "[", 
               RowBox[{
                RowBox[{"Outputfilename", "<>", "\"\<_netfig_thrsh\>\"", "<>", 
                 RowBox[{"ToString", "[", "threshold", "]"}], "<>", 
                 "\"\<.pdf\>\""}], ",", "plot1"}], "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{
              "threshold", ",", "thresholdmin", ",", "thresholdmax", ",", 
               "thresholdjump"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"plotQ", "\[Equal]", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"poplistfileQ", "=", 
          RowBox[{"ChoiceDialog", "[", 
           RowBox[{
           "\"\<Would you like to use a file with population \
coordinates?\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<          Yes         \>\"", "\[Rule]", "0"}], ",", 
              RowBox[{
              "\"\< Input coordinates manually \>\"", "\[Rule]", "1"}]}], 
             "}"}], ",", 
            RowBox[{"WindowSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"500", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"poplistfileQ", "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"popcordlistfilename", "=", 
             RowBox[{"SystemDialogInput", "[", 
              RowBox[{"\"\<FileOpen\>\"", ",", 
               RowBox[{
               "WindowTitle", "\[Rule]", 
                "\"\<Select Population coordinates file\>\""}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"popcordlist", "=", 
             RowBox[{"Import", "[", "popcordlistfilename", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Popcordcheck", "=", 
             RowBox[{"DataCheckPopcords", "[", 
              RowBox[{"popcordlist", ",", "IndlistInfo"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{
               "Popcordcheck", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{
               RowBox[{"DialogInput", "[", 
                RowBox[{
                 RowBox[{"Grid", "[", 
                  RowBox[{"Join", "[", 
                   RowBox[{
                    RowBox[{
                    "Popcordcheck", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"\"\<\>\"", ",", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "}"}],
                     "}"}]}], "]"}], "]"}], ",", 
                 RowBox[{"WindowSize", "\[Rule]", "All"}]}], "]"}], ";", 
               RowBox[{"Quit", "[", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prox", "=", 
             RowBox[{
              RowBox[{"Last", "[", "popcordlist", "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"popcordlist", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"popcordlist", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"popcordlist", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"popcordlist", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                  "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "popcordlist", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"poplistfileQ", "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sampledPops", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"IndlistInfo", ",", "All", ",", "1"}], "]"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"popcordlist", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"DialogInput", "[", 
                RowBox[{"Grid", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Enter coordinates for population \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    "sampledPops", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", "Bold", ",", 
                    "15"}], "]"}], "}"}], ",", 
                   RowBox[{"{", "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<x:\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "x", "]"}], ",", "Number"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"\"\<y:\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "y", "]"}], ",", "Number"}], 
                    "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"DialogReturn", "[", "1", "]"}]}], "]"}], "}"}]}],
                   "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"popcordlist", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "sampledPops", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "sampledPops", "]"}]}], "}"}]}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"DialogInput", "[", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<Enter proximity range for node positions \>\"", ",", 
                   "Bold", ",", "15"}], "]"}], "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Proximity range:\>\"", ",", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "proxinp", "]"}], ",", "Number"}],
                    "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<OK\>\"", ",", 
                   RowBox[{"DialogReturn", "[", "1", "]"}]}], "]"}], "}"}]}], 
               "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"prox", "=", "proxinp"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"algname", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"algorithim", "\[Equal]", "1"}], ",", 
            "\"\<Label Propagation\>\"", ",", 
            RowBox[{"algorithim", "\[Equal]", "2"}], ",", 
            "\"\<Girvan-Newman\>\"", ",", 
            RowBox[{"algorithim", "\[Equal]", "3"}], ",", 
            "\"\<Fast Greedy\>\"", ",", 
            RowBox[{"algorithim", "\[Equal]", "4"}], ",", "\"\<Walktrap\>\"", 
            ",", 
            RowBox[{"algorithim", "\[Equal]", "5"}], ",", "\"\<Spinglass\>\"",
             ",", 
            RowBox[{"algorithim", "\[Equal]", "6"}], ",", 
            "\"\<Leading Eigenvector\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"singlevalue", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plot2", "=", 
             RowBox[{"PlotNetworkCoordinates", "[", 
              RowBox[{
              "GDmatrix", ",", "threshold", ",", "comdet", ",", "popcordlist",
                ",", "prox", ",", "colors"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"plot2", "=", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                  "\"\<     Threshold: \>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                RowBox[{"{", "plot2", "}"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"Outputfilename", "<>", "\"\<_netfig.pdf\>\""}], ",", 
              "plot2"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "singlevalue"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"plot2", "=", 
                RowBox[{"PlotNetworkCoordinates", "[", 
                 RowBox[{"GDmatrix", ",", "threshold", ",", 
                  RowBox[{"comdet", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                   "\[RightDoubleBracket]"}], ",", "popcordlist", ",", "prox",
                   ",", 
                  RowBox[{"colors", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"plot2", "=", 
                RowBox[{"Grid", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                    "\"\<     Threshold: \>\"", "<>", 
                    RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                   RowBox[{"{", "plot2", "}"}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"Outputfilename", "<>", "\"\<_netfig_thsh\>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}], "<>", 
                  "\"\<.pdf\>\""}], ",", "plot2"}], "]"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{
               "threshold", ",", "thresholdmin", ",", "thresholdmax", ",", 
                "thresholdjump"}], "}"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"plotQ", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"poplistfileQ", "=", 
          RowBox[{"ChoiceDialog", "[", 
           RowBox[{
           "\"\<Would you like to use a file with population \
coordinates?\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<          Yes          \>\"", "\[Rule]", "0"}], 
              ",", 
              RowBox[{
              "\"\< Input coordinates manually \>\"", "\[Rule]", "1"}]}], 
             "}"}], ",", 
            RowBox[{"WindowSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"500", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"poplistfileQ", "\[Equal]", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"popcordlistfilename", "=", 
             RowBox[{"SystemDialogInput", "[", 
              RowBox[{"\"\<FileOpen\>\"", ",", 
               RowBox[{
               "WindowTitle", "\[Rule]", 
                "\"\<Select Population coordinates file\>\""}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"popcordlist", "=", 
             RowBox[{"Import", "[", "popcordlistfilename", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prox", "=", 
             RowBox[{
              RowBox[{"Last", "[", "popcordlist", "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"popcordlist", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"popcordlist", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"popcordlist", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"popcordlist", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                  "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"Length", "[", "popcordlist", "]"}], "-", "1"}]}], 
                "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"poplistfileQ", "\[Equal]", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sampledPops", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"IndlistInfo", ",", "All", ",", "1"}], "]"}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"popcordlist", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"inp", "=", 
                RowBox[{"DialogInput", "[", 
                 RowBox[{"Grid", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"\"\<Enter coordinates for population \>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    "sampledPops", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", "Bold", ",", 
                    "15"}], "]"}], "}"}], ",", 
                    RowBox[{"{", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<x:\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "x", "]"}], ",", "Number"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<y:\>\"", ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "y", "]"}], ",", "Number"}], 
                    "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"DialogReturn", "[", "1", "]"}]}], "]"}], "}"}]}],
                    "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"popcordlist", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "sampledPops", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "}"}]}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "sampledPops", "]"}]}], "}"}]}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"DialogInput", "[", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Style", "[", 
                  RowBox[{
                  "\"\<Enter proximity range for node positions \>\"", ",", 
                   "Bold", ",", "15"}], "]"}], "}"}], ",", 
                RowBox[{"{", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"\"\<Proximity range:\>\"", ",", 
                  RowBox[{"InputField", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "proxinp", "]"}], ",", "Number"}],
                    "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<OK\>\"", ",", 
                   RowBox[{"DialogReturn", "[", "1", "]"}]}], "]"}], "}"}]}], 
               "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"prox", "=", "proxinp"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"algname", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"algorithim", "\[Equal]", "1"}], ",", 
            "\"\<Label Propagation\>\"", ",", 
            RowBox[{"algorithim", "\[Equal]", "2"}], ",", 
            "\"\<Girvan-Newman\>\"", ",", 
            RowBox[{"algorithim", "\[Equal]", "3"}], ",", 
            "\"\<Fast Greedy\>\"", ",", 
            RowBox[{"algorithim", "\[Equal]", "4"}], ",", "\"\<Walktrap\>\"", 
            ",", 
            RowBox[{"algorithim", "\[Equal]", "5"}], ",", "\"\<Spinglass\>\"",
             ",", 
            RowBox[{"algorithim", "\[Equal]", "6"}], ",", 
            "\"\<Leading Eigenvector\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"singlevalue", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"plot2", "=", 
             RowBox[{"PlotNetworkCoordinates", "[", 
              RowBox[{
              "GDmatrix", ",", "threshold", ",", "comdet", ",", "popcordlist",
                ",", "prox", ",", "colors"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"plot2", "=", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                  "\"\<     Threshold: \>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                RowBox[{"{", "plot2", "}"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"Outputfilename", "<>", "\"\<_withCoord.pdf\>\""}], ",",
               "plot2"}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"plot1", "=", 
             RowBox[{"PlotNetwork", "[", 
              RowBox[{
              "GDmatrix", ",", "threshold", ",", "comdet", ",", "colors"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"plot1", "=", 
             RowBox[{"Grid", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                  "\"\<     Threshold: \>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                RowBox[{"{", "plot1", "}"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"Outputfilename", "<>", "\"\<_withoutCoord.pdf\>\""}], 
              ",", "plot1"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", "singlevalue"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"plot2", "=", 
                RowBox[{"PlotNetworkCoordinates", "[", 
                 RowBox[{"GDmatrix", ",", "threshold", ",", 
                  RowBox[{"comdet", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                   "\[RightDoubleBracket]"}], ",", "popcordlist", ",", "prox",
                   ",", 
                  RowBox[{"colors", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"plot2", "=", 
                RowBox[{"Grid", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                    "\"\<     Threshold: \>\"", "<>", 
                    RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                   RowBox[{"{", "plot2", "}"}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{"Outputfilename", "<>", "\"\<_withCoord_thsh\>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}], "<>", 
                  "\"\<.pdf\>\""}], ",", "plot2"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"plot1", "=", 
                RowBox[{"PlotNetwork", "[", 
                 RowBox[{"GDmatrix", ",", "threshold", ",", 
                  RowBox[{"comdet", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"colors", "\[LeftDoubleBracket]", 
                   RowBox[{
                    RowBox[{"Round", "[", 
                    FractionBox[
                    RowBox[{"threshold", "-", "thresholdmin"}], 
                    "thresholdjump"], "]"}], "+", "1"}], 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"plot1", "=", 
                RowBox[{"Grid", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "\"\<Algorithim: \>\"", "<>", "algname", "<>", 
                    "\"\<     Threshold: \>\"", "<>", 
                    RowBox[{"ToString", "[", "threshold", "]"}]}], "}"}], ",", 
                   RowBox[{"{", "plot1", "}"}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Export", "[", 
                RowBox[{
                 RowBox[{
                 "Outputfilename", "<>", "\"\<_withoutCoord_thsh\>\"", "<>", 
                  RowBox[{"ToString", "[", "threshold", "]"}], "<>", 
                  "\"\<.pdf\>\""}], ",", "plot1"}], "]"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{
               "threshold", ",", "thresholdmin", ",", "thresholdmax", ",", 
                "thresholdjump"}], "}"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "IndlistInfo", ",", "GDmatrix", ",", "threshold", ",", "algorithim", 
        ",", "comdet", ",", "colors"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SAcom", "[", 
    RowBox[{
    "matrix_", ",", "ind_", ",", "com_", ",", "communities_", ",", "Q_", ",", 
     "comdet_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sacom", ",", "tempcom"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"comdet", "\[LeftDoubleBracket]", 
          RowBox[{"ind", ",", "3"}], "\[RightDoubleBracket]"}], "\[Equal]", 
         "com"}], ",", 
        RowBox[{"sacom", "=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tempcom", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"communities", ",", 
             RowBox[{"ind", "\[Rule]", "com"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sacom", "=", 
          RowBox[{"Q", "-", 
           RowBox[{"Qmodularity", "[", 
            RowBox[{"matrix", ",", "tempcom"}], "]"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "sacom"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SAres", "[", 
    RowBox[{"matrix_", ",", "comdet_", ",", "threshold_"}], "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "is", " ", "for", " ", "the", " ", "output", " ", "file"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"communities", ",", "mat", ",", "Q"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"communities", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"comdet", ",", "All", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{"ApplyThreshold", "[", 
        RowBox[{"matrix", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Qmodularity", "[", 
        RowBox[{"mat", ",", "communities"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "comdet", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
         "~", "Join", "~", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"SAcom", "[", 
            RowBox[{
            "mat", ",", "j", ",", "i", ",", "communities", ",", "Q", ",", 
             "comdet"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Max", "[", "communities", "]"}]}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "mat", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SADlist", "[", 
    RowBox[{"SADres_", ",", "comdet_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "communities", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"communities", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"comdet", ",", "All", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Min", "[", 
           RowBox[{"Delete", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", "2", "}"}], ",", 
               RowBox[{"{", "3", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "i", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                 "+", "3"}], "}"}]}], "}"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Select", "[", 
             RowBox[{"SADres", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
                "\[Equal]", "j"}], "&"}]}], "]"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Max", "[", "communities", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SADDissasociationplots", "[", 
    RowBox[{"sares_", ",", "colors_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"SdisAlist", ",", "barcharts"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SdisAlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"sares", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", 
           RowBox[{"4", ";;", 
            RowBox[{"Length", "[", 
             RowBox[{
             "sares", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}]}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "sares", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"barcharts", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"BarChart", "[", 
           RowBox[{
            RowBox[{"SdisAlist", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"k", "-", "1"}], ")"}], "100"}], "+", "1"}], ";;", 
              RowBox[{"Min", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}], "100"}], "+", "100"}], 
                 ",", 
                 RowBox[{"Length", "[", "SdisAlist", "]"}]}], "}"}], "]"}]}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"ChartLayout", "\[Rule]", "\"\<Stacked\>\""}], ","}], 
             "*)"}], 
            RowBox[{"ChartStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"EdgeForm", "[", "None", "]"}], ",", "colors"}], 
              "}"}]}], ",", 
            RowBox[{"ChartLabels", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Rotate", "[", 
                  RowBox[{
                   RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{"sares", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], "]"}],
                     "<>", "\"\<(\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"sares", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "]"}],
                     "<>", "\"\<)\>\""}], "]"}], ",", 
                   RowBox[{"Pi", "/", "2.4"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}], "100"}], "+", "1"}], ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}], "100"}], "+", "100"}], 
                    ",", 
                    RowBox[{"Length", "[", "SdisAlist", "]"}]}], "}"}], 
                    "]"}]}], "}"}]}], "]"}], ",", "None"}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{
            RowBox[{"Floor", "[", 
             FractionBox[
              RowBox[{"Length", "[", "sares", "]"}], "100"], "]"}], "+", 
            "1"}]}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Grid", "[", 
       RowBox[{"Prepend", "[", 
        RowBox[{"barcharts", ",", 
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Strength of Dissassociation of individuls to non-assigned \
commnunities\>\"", ",", "Bold", ",", "18"}], "]"}], "}"}]}], "]"}], "]"}]}]}],
     "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SADanalysis", "[", "comdetresults_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "IndlistInfo", ",", "GDmatrix", ",", "threshold", ",", "algorithim", 
       ",", "comdet", ",", "sares", ",", "sadres", ",", "lables", ",", "p1", 
       ",", "p2", ",", "p3", ",", "p4", ",", "colors"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IndlistInfo", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GDmatrix", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"threshold", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"algorithim", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "4", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"comdet", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "5", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"colors", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "6", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"comdet", ",", "All", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "]"}], "\[Equal]", 
         "1"}], ",", 
        RowBox[{
         RowBox[{"DialogInput", "[", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "{", "\"\<Only one community detected. SAD analysis not possible\
\>\"", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<OK\>\"", ",", 
                RowBox[{"DialogReturn", "[", "1", "]"}]}], "]"}], "}"}]}], 
            "}"}], "]"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sares", "=", 
          RowBox[{"SAres", "[", 
           RowBox[{"GDmatrix", ",", "comdet", ",", "threshold"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"Outputfilename", "<>", "\"\<_SADFullSAdetails.csv\>\""}], 
           ",", "sares"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"sadres", "=", 
          RowBox[{"SADlist", "[", 
           RowBox[{"sares", ",", "comdet"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"Outputfilename", "<>", "\"\<_SAD.csv\>\""}], ",", 
           "sadres"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"lables", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "i", "]"}], ",", "15"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "sadres", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"p1", "=", 
          RowBox[{"BoxWhiskerChart", "[", 
           RowBox[{"sadres", ",", 
            RowBox[{"ChartLabels", "\[Rule]", "lables"}], ",", 
            RowBox[{"ChartStyle", "\[Rule]", "colors"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{"DistributionChart", "[", 
           RowBox[{"sadres", ",", 
            RowBox[{"ChartLabels", "\[Rule]", "lables"}], ",", 
            RowBox[{"ChartStyle", "\[Rule]", "colors"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p3", "=", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"#", ",", "Bold", ",", "17"}], "]"}], "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{
               "\"\<SAD Box-Whixker chart\>\"", ",", 
                "\"\<SAD Distribution chart\>\""}], "}"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"p1", ",", "p2"}], "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"Outputfilename", "<>", "\"\<_SADcharts.pdf\>\""}], ",", 
           "p3"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"p4", "=", 
          RowBox[{"SADDissasociationplots", "[", 
           RowBox[{"sares", ",", "colors"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"Outputfilename", "<>", "\"\<_SdissAcharts.pdf\>\""}], ",",
            "p4"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"createfreqlist", "[", "indlist_", "]"}], ":=", 
   RowBox[{"(*", 
    RowBox[{
    "Here", " ", "\"\<N\>\"", " ", "is", " ", "given", " ", "as", " ", "the", 
     " ", "symbol", " ", "for", " ", "missing", " ", "data"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Nloci", ",", "freqlist", ",", "t1", ",", "t2", ",", "t3"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Nloci", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"indlist", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"freqlist", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"t1", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"indlist", "\[LeftDoubleBracket]", 
                RowBox[{"k", ",", "3", ",", "h"}], "\[RightDoubleBracket]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", "indlist", "]"}]}], "}"}]}], "]"}], 
             "]"}], ",", "\"\<N\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t2", "=", 
          RowBox[{"Tally", "[", "t1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"t3", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#1", ",", 
              RowBox[{"N", "[", 
               FractionBox["#2", 
                RowBox[{"Length", "[", "t1", "]"}]], "]"}]}], "}"}], "&"}], "@@@",
            "t2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"freqlist", ",", "t3"}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"h", ",", "Nloci"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "freqlist"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freq", "[", 
   RowBox[{"allele_", ",", "l_", ",", "freqlist_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
      "freqlist", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[Equal]", "allele"}], "&"}]}], "]"}], "\[LeftDoubleBracket]", 
    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "\[IndentingNewLine]",
    ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WeightedSimilarityGD", "[", 
    RowBox[{"ind1_", ",", "ind2_", ",", "freqlist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Nloci", ",", "missingLoci", ",", "sum", ",", "a", ",", "b", ",", "c", 
       ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Nloci", "=", 
       RowBox[{"Length", "[", 
        RowBox[{
        "ind1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"missingLoci", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sum", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "=", 
          RowBox[{"ind1", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "l", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"b", "=", 
          RowBox[{"ind1", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "l", ",", "2"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"c", "=", 
          RowBox[{"ind2", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "l", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"ind2", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "l", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], ",", "0"}], 
            "]"}], ",", 
           RowBox[{"missingLoci", "=", 
            RowBox[{"missingLoci", "+", "1"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"sum", "=", 
             RowBox[{"sum", "+", 
              RowBox[{
               FractionBox["1", "4"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", 
                    RowBox[{"freq", "[", 
                    RowBox[{"a", ",", "l", ",", "freqlist"}], "]"}]}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "c"}], ",", "1", ",", "0"}], 
                    "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"a", "\[Equal]", "d"}], ",", "1", ",", "0"}], 
                    "]"}]}], ")"}]}], "+", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{
                    RowBox[{"freq", "[", 
                    RowBox[{"b", ",", "l", ",", "freqlist"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b", "\[Equal]", "c"}], ",", "1", ",", "0"}], 
                    "]"}], "+", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"b", "\[Equal]", "d"}], ",", "1", ",", "0"}], 
                    "]"}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "Nloci"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Nloci", "-", "missingLoci"}], "\[Equal]", "0"}], ",", "0", 
        ",", 
        FractionBox["sum", 
         RowBox[{"Nloci", "-", "missingLoci"}]]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildGeneticNetwork", "[", "indlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"freqlist", ",", "n", ",", "mm"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"freqlist", "=", 
       RowBox[{"createfreqlist", "[", "indlist", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "indlist", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mm", "=", 
       RowBox[{"ParallelTable", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "j"}], ",", 
             RowBox[{"WeightedSimilarityGD", "[", 
              RowBox[{
               RowBox[{
               "indlist", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "indlist", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}], ",", "freqlist"}], "]"}], ",", 
             "0"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mm", "+", 
       RowBox[{"Transpose", "[", "mm", "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DataCheckGenotypes", "[", 
    RowBox[{"data_", ",", "type_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "DataOKQ", ",", "DataOKQ1", ",", "DataOKQ2", ",", "DataOKQ3", ",", 
       "DataOKQ4", ",", "DataOKQ5", ",", "errorlines"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DataOKQ1", "=", "False"}], ";", 
      RowBox[{"DataOKQ2", "=", "False"}], ";", 
      RowBox[{"DataOKQ3", "=", "False"}], ";", 
      RowBox[{"DataOKQ4", "=", "False"}], ";", 
      RowBox[{"DataOKQ5", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"errorlines", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<The data files are not \>\"", ",", "\"\<\>\""}], "}"}],
          ",", 
         RowBox[{"{", 
          RowBox[{"\"\<in the correct format:\>\"", ",", "\"\<\>\""}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "==", "\"\<MX\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "data", "]"}], "\[LeftDoubleBracket]",
              "2", "\[RightDoubleBracket]"}], "==", "3"}], ",", 
           RowBox[{"DataOKQ1", "=", "True"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{
             "{", "\"\<Length of individuals is not 3 (ID,pop,Genotypes)\>\"",
               "}"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}], "==", "2"}], 
            "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "1", "}"}]}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             "1"}]}], ",", 
           RowBox[{"DataOKQ2", "=", "True"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{"{", "\"\<Populations name wrong format\>\"", "}"}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "]"}], "]"}], "==", "2"}], 
            "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             "1"}]}], ",", 
           RowBox[{"DataOKQ3", "=", "True"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{"{", "\"\<Individual's name wrong format\>\"", "}"}]}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}], "]"}], "==", "4"}], 
            "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "==", 
             "1"}], "&&", 
            RowBox[{
             RowBox[{
              RowBox[{"Dimensions", "[", 
               RowBox[{"Take", "[", 
                RowBox[{"data", ",", "All", ",", 
                 RowBox[{"{", "3", "}"}]}], "]"}], "]"}], 
              "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "==", 
             "2"}]}], ",", 
           RowBox[{"DataOKQ4", "=", "True"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{"{", "\"\<Genotypes wrong format\>\"", "}"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"DataOKQ", "=", 
          RowBox[{
          "DataOKQ1", "&&", "DataOKQ2", "&&", "DataOKQ3", "&&", 
           "DataOKQ4"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "==", "\"\<CSV\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Dimensions", "[", "data", "]"}], "]"}], "==", "2"}], "&&", 
            RowBox[{"EvenQ", "[", 
             RowBox[{
              RowBox[{"Dimensions", "[", "data", "]"}], 
              "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}]}],
            ",", 
           RowBox[{"DataOKQ5", "=", "True"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"errorlines", ",", 
             RowBox[{"{", "\"\<Wrong format\>\"", "}"}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"DataOKQ", "=", "DataOKQ5"}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"DataOKQ", ",", "errorlines"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ConstructGDmatrix", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "FormatOKQ", ",", "filetypeQ", ",", "Indlistfilename", ",", 
       "OutputfilenameMatrix", ",", "datacheck"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"filetypeQ", "=", 
       RowBox[{"ChoiceDialog", "[", 
        RowBox[{"\"\<What type of input file do you have?\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<MX\>\"", "\[Rule]", "0"}], ",", 
           RowBox[{"\"\<CSV\>\"", "\[Rule]", "1"}]}], "}"}], ",", 
         RowBox[{"WindowSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"200", ",", "100"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Indlistfilename", "=", 
       RowBox[{"SystemDialogInput", "[", 
        RowBox[{"\"\<FileOpen\>\"", ",", 
         RowBox[{
         "WindowTitle", "\[Rule]", 
          "\"\<Select Genetic-Distance matrix file\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"filetypeQ", "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"Indlist", "=", 
          RowBox[{"Import", "[", "Indlistfilename", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"datacheck", "=", 
          RowBox[{"DataCheckGenotypes", "[", 
           RowBox[{"Indlist", ",", "\"\<MX\>\""}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"filetypeQ", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Indlist", "=", 
          RowBox[{"Import", "[", 
           RowBox[{"Indlistfilename", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"datacheck", "=", 
          RowBox[{"DataCheckGenotypes", "[", 
           RowBox[{"Indlist", ",", "\"\<CSV\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "datacheck", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Indlist", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Indlist", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", 
                 RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], "~", 
               "Join", "~", 
               RowBox[{"{", 
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Indlist", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"3", ";;", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "Indlist", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}]}]}], "]"}], "]"}], ",", 
                  "2"}], "]"}], "}"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "Indlist", "]"}]}], "}"}]}], "]"}]}]}],
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
        "datacheck", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OutputfilenameMatrix", "=", 
          RowBox[{"SystemDialogInput", "[", 
           RowBox[{"\"\<FileSave\>\"", ",", 
            RowBox[{
            "WindowTitle", "\[Rule]", 
             "\"\<Select output folder and file name for Genetic-Distance \
matrix and Individuals information list\>\""}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"GDmatrix", "=", 
          RowBox[{"BuildGeneticNetwork", "[", "Indlist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"IndlistInfo", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"Indlist", ",", "All", ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"OutputfilenameMatrix", "<>", "\"\<_GDmatrix.mx\>\""}], 
           ",", "GDmatrix"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"OutputfilenameMatrix", "<>", "\"\<_IndlistInfo.mx\>\""}], 
           ",", "IndlistInfo"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"continuefeomcontructQ", "=", 
          RowBox[{"ChoiceDialog", "[", 
           RowBox[{
           "\"\<Would like to continue to perform community detection?\>\"", 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<         No          \>\"", "\[Rule]", "0"}], ",", 
              RowBox[{"\"\<          Yes          \>\"", "\[Rule]", "1"}]}], 
             "}"}], ",", 
            RowBox[{"WindowSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"400", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"continuefeomcontructQ", "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"DialogInput", "[", 
             RowBox[{
              RowBox[{"Grid", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<The GDmatrix and IndlistInfo\>\"", ",", "\"\<\>\""}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<files have been constructed\>\"", ",", "\"\<\>\""}], 
                  "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<\>\"", ",", 
                   RowBox[{"Button", "[", 
                    RowBox[{"\"\<OK\>\"", ",", 
                    RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], 
                  "}"}]}], "}"}], "]"}], ",", 
              RowBox[{"WindowSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"350", ",", "100"}], "}"}]}]}], "]"}], ";"}], ",", 
           RowBox[{"RunCommunityDetection", "[", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{
         "datacheck", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DialogInput", "[", 
          RowBox[{
           RowBox[{"Grid", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
              "datacheck", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{"\"\<\>\"", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<OK\>\"", ",", 
                   RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "}"}], 
               "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"WindowSize", "\[Rule]", "All"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermtestGDmatrix", "[", 
    RowBox[{
    "GDmatrix_", ",", "algorithim_", ",", "threshold_", ",", "Npermutations_",
      ",", "comdet_", ",", "IndlistInfo_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "communities", ",", "mat", ",", "Q", ",", "n", ",", "values", ",", 
       "permres", ",", "permvalues", ",", "ma", ",", "line", ",", 
       "permGDmatrix", ",", "tempcomdet", ",", "Qperm"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"communities", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"comdet", ",", "All", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{"ApplyThreshold", "[", 
        RowBox[{"GDmatrix", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Q", "=", 
       RowBox[{"Qmodularity", "[", 
        RowBox[{"mat", ",", "communities"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "GDmatrix", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"values", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"GDmatrix", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ";;", "n"}]}], 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"permres", "=", 
       RowBox[{"{", "Q", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"permvalues", "=", 
          RowBox[{"RandomSample", "[", "values", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ma", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"line", "=", 
             RowBox[{"PadLeft", "[", 
              RowBox[{
               RowBox[{"permvalues", "\[LeftDoubleBracket]", 
                RowBox[{"1", ";;", 
                 RowBox[{"n", "-", "i"}]}], "\[RightDoubleBracket]"}], ",", 
               "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"permvalues", "=", 
             RowBox[{"permvalues", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"n", "-", "i", "+", "1"}], ";;", 
               RowBox[{"Length", "[", "permvalues", "]"}]}], 
              "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"ma", ",", "line"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"ma", ",", 
           RowBox[{"Table", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"permGDmatrix", "=", 
          RowBox[{"ma", "+", 
           RowBox[{"Transpose", "[", "ma", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempcomdet", "=", 
          RowBox[{"CommunityDetection", "[", 
           RowBox[{
           "permGDmatrix", ",", "threshold", ",", "algorithim", ",", 
            "IndlistInfo"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"communities", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"tempcomdet", ",", "All", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mat", "=", 
          RowBox[{"ApplyThreshold", "[", 
           RowBox[{"permGDmatrix", ",", "threshold"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Qperm", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", "communities", "]"}], "\[Equal]", "1"}], ",",
             "0", ",", 
            RowBox[{"Qmodularity", "[", 
             RowBox[{"mat", ",", "communities"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"permres", ",", "Qperm"}], "]"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", "Npermutations", "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "permres"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"permutegenepool", "[", 
    RowBox[{"indlist_", ",", "locus_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gp1", ",", "gp2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"gp1", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"indlist", ",", "All", ",", 
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"{", "locus", "}"}]}], "]"}], "]"}]}], ";"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gp2", "=", 
       RowBox[{"RandomSample", "[", "gp1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Partition", "[", 
       RowBox[{"gp2", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermuteIndlist", "[", "indlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2", ",", "newindlist"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"permutegenepool", "[", 
          RowBox[{"indlist", ",", "l"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"l", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"indlist", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "]"}]}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", "=", 
       RowBox[{"Transpose", "[", "t1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newindlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"indlist", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"indlist", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "t2", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "indlist", "]"}]}], "}"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PermtestIndlist", "[", 
    RowBox[{
    "GDmatrix_", ",", "algorithim_", ",", "threshold_", ",", "Npermutations_",
      ",", "comdet_", ",", "indlist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "communities", ",", "mat", ",", "permres", ",", "tempindlist", ",", 
       "tempGDmatrix", ",", "tempcomdet", ",", "Qperm"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"communities", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Take", "[", 
         RowBox[{"comdet", ",", "All", ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mat", "=", 
       RowBox[{"ApplyThreshold", "[", 
        RowBox[{"GDmatrix", ",", "threshold"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"permres", "=", 
       RowBox[{"{", 
        RowBox[{"Qmodularity", "[", 
         RowBox[{"mat", ",", "communities"}], "]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempindlist", "=", 
          RowBox[{"PermuteIndlist", "[", "indlist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempGDmatrix", "=", 
          RowBox[{"BuildGeneticNetwork", "[", "tempindlist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempcomdet", "=", 
          RowBox[{"CommunityDetection", "[", 
           RowBox[{
           "tempGDmatrix", ",", "threshold", ",", "algorithim", ",", 
            "IndlistInfo"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"communities", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Take", "[", 
            RowBox[{"tempcomdet", ",", "All", ",", 
             RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mat", "=", 
          RowBox[{"ApplyThreshold", "[", 
           RowBox[{"tempGDmatrix", ",", "threshold"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Qperm", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Max", "[", "communities", "]"}], "\[Equal]", "1"}], ",",
             "0", ",", 
            RowBox[{"Qmodularity", "[", 
             RowBox[{"mat", ",", "communities"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"permres", ",", "Qperm"}], "]"}]}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", "Npermutations", "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "permres"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sigPlot", "[", "permlist_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"actmod", ",", "q95", ",", "sig", ",", "plot", ",", "sigline"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"actmod", "=", 
       RowBox[{
       "permlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"q95", "=", 
       RowBox[{"Quantile", "[", 
        RowBox[{"permlist", ",", 
         RowBox[{"{", 
          RowBox[{"0.025", ",", "0.975"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sig", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"actmod", ">", 
          RowBox[{
          "q95", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Histogram", "[", 
          RowBox[{"permlist", ",", "20", ",", 
           RowBox[{"Axes", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"actmod", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"actmod", ",", 
               RowBox[{"Length", "[", "permlist", "]"}]}], "}"}]}], "}"}], 
           ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}], ",", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "q95", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "q95", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Length", "[", "permlist", "]"}]}], "}"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "q95", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "q95", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"Length", "[", "permlist", "]"}]}], "}"}]}], "}"}]}],
             "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Black", ",", "Dashed"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"Black", ",", "Dashed"}], "}"}]}], "}"}]}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigline", "=", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
          "sig", ",", "\"\<Modularity significant (p<0.05)\>\"", ",", 
           "\"\<Modularity non-significant (p<0.05)\>\""}], "]"}], ",", "Red",
          ",", "13"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Significance of the detected modularity\>\"", ",", "Bold", 
            ",", "15"}], "]"}], "}"}], ",", 
         RowBox[{"{", "plot", "}"}], ",", 
         RowBox[{"{", "sigline", "}"}], ",", 
         RowBox[{
         "{", "\"\<Dashed lines indicates 95% confidence interval\>\"", "}"}],
          ",", 
         RowBox[{
         "{", "\"\<Red lines indicates the modularity of the detected \
partition\>\"", "}"}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PerumtationTest", "[", "comdetresults_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "IndlistInfo", ",", "GDmatrix", ",", "threshold", ",", "algorithim", 
       ",", "comdet", ",", "permQ", ",", "permlist", ",", "sig1"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"IndlistInfo", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"GDmatrix", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"threshold", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "3", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"algorithim", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "4", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"comdet", "=", 
       RowBox[{
       "comdetresults", "\[LeftDoubleBracket]", "5", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"inputtypeQ", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"permQ", "=", 
          RowBox[{"ChoiceDialog", "[", 
           RowBox[{
           "\"\<Would like to permute the Genetic-Distance matrix or the \
genotypes?\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\< Genetic matrix \>\"", "\[Rule]", "0"}], ",", 
              RowBox[{"\"\< Genotypes \>\"", "\[Rule]", "1"}]}], "}"}], ",", 
            RowBox[{"WindowSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"400", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"DialogInput", "[", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "{", "\"\<How many permutations (recommended at least \
1000)?\>\"", "}"}], ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Number of permutations:\>\"", ",", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "Npermutations", "]"}], ",", 
                 "Number"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<OK\>\"", ",", 
                RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], "}"}]}], 
            "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"permQ", "\[Equal]", "0"}], ",", 
           RowBox[{"permlist", "=", 
            RowBox[{"PermtestGDmatrix", "[", 
             RowBox[{
             "GDmatrix", ",", "algorithim", ",", "threshold", ",", 
              "Npermutations", ",", "comdet", ",", "IndlistInfo"}], "]"}]}]}],
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"permQ", "\[Equal]", "1"}], ",", 
           RowBox[{"permlist", "=", 
            RowBox[{"PermtestIndlist", "[", 
             RowBox[{
             "GDmatrix", ",", "algorithim", ",", "threshold", ",", 
              "Npermutations", ",", "comdet", ",", "Indlist"}], "]"}]}]}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"inputtypeQ", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DialogInput", "[", 
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "{", "\"\<The Genetic distance matrix will permuted (no genotype \
data entered).\n How many permutations (recommended at least 999)?\>\"", 
              "}"}], ",", 
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Number of permutations:\>\"", ",", 
               RowBox[{"InputField", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "Npermutations", "]"}], ",", 
                 "Number"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<OK\>\"", ",", 
                RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], "}"}]}], 
            "}"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"permlist", "=", 
          RowBox[{"PermtestGDmatrix", "[", 
           RowBox[{
           "GDmatrix", ",", "algorithim", ",", "threshold", ",", 
            "Npermutations", ",", "comdet", ",", "IndlistInfo"}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sig1", "=", 
       RowBox[{"sigPlot", "[", "permlist", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{
        "Outputfilename", "<>", "\"\<_ModularitySignificanceTest.pdf\>\""}], 
        ",", "sig1"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Global", " ", 
    RowBox[{"parameters", ":", "\[IndentingNewLine]", 
     RowBox[{
     "inputtypeQ", "\[IndentingNewLine]", "Indlist", "\[IndentingNewLine]", 
      "singlevalue", "\[IndentingNewLine]", "continuefeomcontructQ", 
      "\[IndentingNewLine]", "comdetresults", "\[IndentingNewLine]", 
      "Outputfilename"}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NetStruct", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"continuefeomcontructQ", "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ggg", "=", 
     RowBox[{"RandomGraph", "[", 
      RowBox[{"BernoulliGraphDistribution", "[", 
       RowBox[{"50", ",", "0.4"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\"\<\>\"", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<  \>\"", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<NetStruct\>\"", ",", "Bold", ",", "40"}], "]"}], 
           ",", "\"\<  \>\""}], "}"}], ",", 
         RowBox[{"{", "\"\<\>\"", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<  \>\"", ",", 
           RowBox[{"Item", "[", 
            RowBox[{
             RowBox[{"Image", "[", 
              RowBox[{
               RowBox[{"CommunityGraphPlot", "[", 
                RowBox[{"ggg", ",", 
                 RowBox[{"FindGraphCommunities", "[", "ggg", "]"}]}], "]"}], 
               ",", 
               RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
             RowBox[{"ItemSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"30", ",", "18"}], "}"}]}]}], "]"}], ",", 
           "\"\<  \>\""}], "}"}], ",", 
         RowBox[{"{", "\"\<\>\"", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<  \>\"", ",", 
           RowBox[{"Item", "[", 
            RowBox[{"\"\<Version 1.2\>\"", ",", 
             RowBox[{"Alignment", "\[Rule]", "Right"}]}], "]"}], ",", 
           "\"\<  \>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<  \>\"", ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<OK\>\"", ",", 
             RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}], ",", 
           "\"\<  \>\""}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"WindowSize", "\[Rule]", "All"}], ",", 
      RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"inputtypeQ", "=", 
     RowBox[{"ChoiceDialog", "[", 
      RowBox[{
      "\"\<Would like to contruct a genetic-distance matrix from genotype \
data or would like to use a pre-prepared matrix?\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\< Genotype data \>\"", "\[Rule]", "0"}], ",", 
         RowBox[{"\"\< Pre-prepared matrix \>\"", "\[Rule]", "1"}]}], "}"}], 
       ",", 
       RowBox[{"WindowSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"400", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"inputtypeQ", "\[Equal]", "0"}], ",", 
      RowBox[{"ConstructGDmatrix", "[", "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"inputtypeQ", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"comdetresults", "=", 
        RowBox[{"RunCommunityDetection", "[", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"singlevalue", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SADQ", "=", 
           RowBox[{"ChoiceDialog", "[", 
            RowBox[{"\"\<Would you like to perform SAD analysis?\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<          No          \>\"", "\[Rule]", "0"}], 
               ",", 
               RowBox[{"\"\<          Yes          \>\"", "\[Rule]", "1"}]}], 
              "}"}], ",", 
             RowBox[{"WindowSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"200", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"SADQ", "\[Equal]", "1"}], ",", 
            RowBox[{"SADanalysis", "[", "comdetresults", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"sigtestQ", "=", 
           RowBox[{"ChoiceDialog", "[", 
            RowBox[{
            "\"\<Would like to conduct a significance test for the detected \
community partition?\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<          No          \>\"", "\[Rule]", "0"}], 
               ",", 
               RowBox[{"\"\<          Yes          \>\"", "\[Rule]", "1"}]}], 
              "}"}], ",", 
             RowBox[{"WindowSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"400", ",", "150"}], "}"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"sigtestQ", "\[Equal]", "1"}], ",", 
            RowBox[{"PerumtationTest", "[", "comdetresults", "]"}]}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"DialogInput", "[", 
     RowBox[{
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<Thank you for using NetStruct!\>\"", ",", "\"\<\>\""}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", 
           RowBox[{"Button", "[", 
            RowBox[{"\"\<OK\>\"", ",", 
             RowBox[{"DialogReturn", "[", "1", "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "100"}]}], "]"}]}], "}"}]}], 
        "}"}], "]"}], ",", 
      RowBox[{"WindowSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"300", ",", "100"}], "}"}]}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellChangeTimes->{{3.646299945740319*^9, 3.6462999778681564`*^9}, {
   3.6463001167681007`*^9, 3.646300338184765*^9}, {3.6463003725317297`*^9, 
   3.6463004259057827`*^9}, {3.646300578022483*^9, 3.6463007234688025`*^9}, {
   3.64630075770076*^9, 3.6463008715442715`*^9}, {3.6463009222971745`*^9, 
   3.646300960231344*^9}, {3.64630100893513*^9, 3.646301052244607*^9}, 
   3.646301087698635*^9, 3.6463025201495667`*^9, {3.64630439637088*^9, 
   3.6463044130768356`*^9}, {3.6463044488078794`*^9, 3.646304531349601*^9}, 
   3.646305448643067*^9, 3.6463056502045956`*^9, {3.6463056950641613`*^9, 
   3.646305698763373*^9}, 3.646305921577117*^9, {3.6463061506872215`*^9, 
   3.646306153568386*^9}, 3.6463062333509493`*^9, {3.6463062773224645`*^9, 
   3.6463062779124985`*^9}, {3.646306771710742*^9, 3.6463067730558186`*^9}, {
   3.646306803074536*^9, 3.646306808842866*^9}, {3.646377579174697*^9, 
   3.646377630241618*^9}, {3.6463777338985467`*^9, 3.6463777482633686`*^9}, {
   3.646378148119239*^9, 3.646378265572957*^9}, {3.646378627728671*^9, 
   3.64637862946677*^9}, {3.6463788974040956`*^9, 3.6463789250516768`*^9}, 
   3.64637901322972*^9, {3.6463790587533245`*^9, 3.6463790950764017`*^9}, {
   3.646386742091383*^9, 3.646386742407401*^9}, {3.646386780311569*^9, 
   3.6463868724538393`*^9}, {3.6463869105020156`*^9, 3.6463870729463067`*^9}, 
   3.646387482445729*^9, {3.646388271127839*^9, 3.6463883875664988`*^9}, {
   3.646388450725111*^9, 3.6463884706002483`*^9}, {3.646388792244645*^9, 
   3.646388808645583*^9}, {3.6463888523380823`*^9, 3.6463888539191723`*^9}, {
   3.646388941479181*^9, 3.6463889420702143`*^9}, {3.646389445018982*^9, 
   3.646389580909754*^9}, {3.6463901798710127`*^9, 3.646390206505536*^9}, {
   3.6463903946372967`*^9, 3.6463904303233376`*^9}, {3.6463905087638245`*^9, 
   3.6463906841798573`*^9}, {3.6463907335396805`*^9, 
   3.6463907641924343`*^9}, {3.646390813030227*^9, 3.64639099053838*^9}, {
   3.646391024997351*^9, 3.6463910916481633`*^9}, {3.6463912486311426`*^9, 
   3.6463913283066998`*^9}, {3.6463914138935947`*^9, 
   3.6463914397380733`*^9}, {3.64639147325099*^9, 3.646391477190215*^9}, {
   3.6463915781479893`*^9, 3.6463916656499944`*^9}, {3.6463917012620316`*^9, 
   3.646391768167858*^9}, {3.6463920654068594`*^9, 3.6463921889209237`*^9}, {
   3.6463924210862026`*^9, 3.64639242592848*^9}, {3.6463924751632957`*^9, 
   3.646392478873508*^9}, {3.646392694546844*^9, 3.6463926952948866`*^9}, {
   3.6463927413635216`*^9, 3.6463927918024063`*^9}, {3.6464514066399837`*^9, 
   3.6464515333202295`*^9}, {3.646451567215168*^9, 3.646451583966126*^9}, {
   3.646451736154831*^9, 3.646451756126973*^9}, {3.6464517977753553`*^9, 
   3.646451949814051*^9}, {3.6464519986288433`*^9, 3.6464520586442757`*^9}, {
   3.646452414309619*^9, 3.6464524787323036`*^9}, {3.646452632735112*^9, 
   3.646452634742227*^9}, {3.6464527798805285`*^9, 3.64645278830301*^9}, {
   3.6464528849385376`*^9, 3.646452952171383*^9}, {3.646453357340557*^9, 
   3.646453388959366*^9}, {3.6464599578800864`*^9, 3.6464599810844135`*^9}, {
   3.6464600426879373`*^9, 3.6464600826742244`*^9}, {3.646460511352743*^9, 
   3.6464606342537727`*^9}, {3.6464609631845865`*^9, 3.646460981705646*^9}, {
   3.646461100624448*^9, 3.6464615748215704`*^9}, {3.646461670673053*^9, 
   3.64646167989658*^9}, {3.646461772273864*^9, 3.646461772668886*^9}, {
   3.6464618026696024`*^9, 3.6464618694814243`*^9}, {3.6464754957223005`*^9, 
   3.646475526400055*^9}, {3.6464768659236717`*^9, 3.646476939934905*^9}, {
   3.64647701748534*^9, 3.646477019612462*^9}, {3.646477130814822*^9, 
   3.6464771705140934`*^9}, 3.646477293904151*^9, {3.646477386668456*^9, 
   3.64647750212506*^9}, {3.646478406770803*^9, 3.646478454766548*^9}, {
   3.6464787298872843`*^9, 3.6464787333194804`*^9}, {3.646478868323202*^9, 
   3.646478889068389*^9}, 3.6464791086759496`*^9, 3.646479750225793*^9, {
   3.6464797855072613`*^9, 3.6464797915372734`*^9}, {3.6464803833726096`*^9, 
   3.646480406920073*^9}, {3.646481555452077*^9, 3.64648155812823*^9}, {
   3.64648160796008*^9, 3.646481627523199*^9}, {3.6464818569943237`*^9, 
   3.646481857512354*^9}, {3.646540389132554*^9, 3.6465403895705795`*^9}, {
   3.6465404217764215`*^9, 3.6465405289285502`*^9}, 3.646540590212055*^9, {
   3.6465406597990355`*^9, 3.64654072474475*^9}, {3.646542339236094*^9, 
   3.6465423989205074`*^9}, {3.646555022889557*^9, 3.6465550234805913`*^9}, {
   3.646891214372141*^9, 3.646891230580068*^9}, {3.6468913684579544`*^9, 
   3.6468914765251355`*^9}, {3.6468916491010065`*^9, 
   3.6468916538352766`*^9}, {3.6468917388311386`*^9, 
   3.6468917486577005`*^9}, {3.646891785169789*^9, 3.6468917903740864`*^9}, {
   3.646891833779569*^9, 3.6468918370187545`*^9}, {3.646891894372035*^9, 
   3.6468919452159433`*^9}, {3.649826940911213*^9, 3.649826942885326*^9}, {
   3.6498422127457104`*^9, 3.649842256292201*^9}, 3.6507823144821396`*^9, {
   3.6507823583856506`*^9, 3.6507823980709205`*^9}, {3.6507829471963286`*^9, 
   3.6507829776110687`*^9}, {3.650783158999443*^9, 3.6507832473324957`*^9}, 
   3.650784118048298*^9, {3.650784148113017*^9, 3.6507844513033586`*^9}, {
   3.6507845050504327`*^9, 3.650784558784506*^9}, {3.6507875167404847`*^9, 
   3.6507875195906477`*^9}, 3.6507879036106124`*^9, {3.6507944548735576`*^9, 
   3.650794562829765*^9}, {3.65079461778767*^9, 3.650794791181815*^9}, {
   3.6507948820873785`*^9, 3.650794921716056*^9}, {3.650794957818925*^9, 
   3.6507949842613764`*^9}, {3.650795080758357*^9, 3.650795137935466*^9}, {
   3.6507976199787545`*^9, 3.6507976342655716`*^9}, {3.650797665759373*^9, 
   3.650797714815179*^9}, {3.6507978092965827`*^9, 3.650798063549125*^9}, {
   3.65079815944361*^9, 3.6507981674380674`*^9}, {3.6507981999969296`*^9, 
   3.6507982638925843`*^9}, {3.650798309874214*^9, 3.650798354266753*^9}, {
   3.650798389786785*^9, 3.650798411821045*^9}, {3.6507984507182703`*^9, 
   3.6507987169174957`*^9}, {3.650798816071167*^9, 3.6507988888233285`*^9}, {
   3.6507992683076286`*^9, 3.650799295468182*^9}, {3.650799809958609*^9, 
   3.650799956290979*^9}, {3.6507999977063475`*^9, 3.650800034272439*^9}, {
   3.6508000721086035`*^9, 3.650800160362651*^9}, 3.650800300370659*^9, {
   3.650863683032823*^9, 3.6508636888831577`*^9}, {3.651458096116719*^9, 
   3.6514581073579435`*^9}, {3.651458771292838*^9, 3.651458841190634*^9}, {
   3.6514595099937787`*^9, 3.651459541427952*^9}, 3.6514596923721066`*^9, 
   3.651459784174715*^9, {3.651460537038082*^9, 3.6514605657601085`*^9}, 
   3.6514606374577956`*^9, 3.6514607240415325`*^9, {3.6514610426403413`*^9, 
   3.651461084357727*^9}, {3.6514636458705697`*^9, 3.6514636734222183`*^9}, {
   3.6514638920050025`*^9, 3.6514639499027042`*^9}, {3.6514641965083284`*^9, 
   3.651464219246573*^9}, {3.651464255350445*^9, 3.6514643420401993`*^9}, {
   3.651464377270463*^9, 3.6514644057757177`*^9}, {3.6514644547390523`*^9, 
   3.651464455129053*^9}, {3.6514645075791707`*^9, 3.651464764694695*^9}, {
   3.6514649168132176`*^9, 3.651464918841221*^9}, {3.6514651181532536`*^9, 
   3.6514651280358734`*^9}, {3.651465619776778*^9, 3.6514657754762764`*^9}, 
   3.6514658387077208`*^9, {3.6514661341519012`*^9, 3.6514661351051545`*^9}, {
   3.6514661729084263`*^9, 3.6514662349818287`*^9}, {3.6514662652126865`*^9, 
   3.6514662761946898`*^9}, {3.651466307519205*^9, 3.6514663126480846`*^9}, {
   3.6514663609509335`*^9, 3.6514663779206624`*^9}, {3.651466423966774*^9, 
   3.651466453745395*^9}, {3.651466696078041*^9, 3.651466696393059*^9}, {
   3.6514669906883116`*^9, 3.6514669963794303`*^9}, {3.65146771801896*^9, 
   3.651467739473325*^9}, {3.651467902459029*^9, 3.6514679757728295`*^9}, 
   3.6514680423374724`*^9, {3.651468075994315*^9, 3.6514681866417418`*^9}, {
   3.6514682338777237`*^9, 3.6514685086650977`*^9}, {3.651468566371066*^9, 
   3.651468658951727*^9}, {3.6514687081668186`*^9, 3.65146873965374*^9}, {
   3.651468770772644*^9, 3.6514688283267765`*^9}, {3.651468914375861*^9, 
   3.651468996467551*^9}, {3.6514690427092867`*^9, 3.6514690869167156`*^9}, {
   3.651469127345135*^9, 3.6514691713645535`*^9}, {3.6514695520697994`*^9, 
   3.6514696154248533`*^9}, {3.6514698624586887`*^9, 
   3.6514698700727053`*^9}, {3.6514699122232175`*^9, 3.651469953256671*^9}, {
   3.651469984002757*^9, 3.6514700287352076`*^9}, {3.6514800044617834`*^9, 
   3.651480215437745*^9}, 3.6514802554817295`*^9, {3.6515418862501497`*^9, 
   3.6515419748496733`*^9}, {3.651542049181196*^9, 3.6515420617733*^9}, {
   3.651542094489115*^9, 3.6515422015932617`*^9}, {3.6515423085988607`*^9, 
   3.651542312016849*^9}, {3.6515424874568744`*^9, 3.6515424961953697`*^9}, {
   3.65154254427746*^9, 3.6515425696246862`*^9}, {3.6515426468976355`*^9, 
   3.6515426506888523`*^9}, {3.6515427040906267`*^9, 3.651542729738468*^9}, {
   3.651542803916461*^9, 3.6515428170115976`*^9}, {3.6515428894982777`*^9, 
   3.6515428909131565`*^9}, 3.651543075198554*^9, 3.6515432395938444`*^9, {
   3.651543271361623*^9, 3.6515432923097863`*^9}, {3.6515433383019857`*^9, 
   3.6515434188219705`*^9}, {3.6515434496068993`*^9, 3.651543613727187*^9}, {
   3.651543662543509*^9, 3.6515437331593237`*^9}, {3.651543916431592*^9, 
   3.651543924033816*^9}, {3.6515439806610503`*^9, 3.6515440460213532`*^9}, {
   3.6515446021251855`*^9, 3.6515446847690983`*^9}, {3.6515447894860153`*^9, 
   3.651544790200056*^9}, {3.6515449108279557`*^9, 3.651544915828242*^9}, {
   3.6515450134858274`*^9, 3.6515450861259823`*^9}, 3.651545258954587*^9, {
   3.6515453267318344`*^9, 3.651545353560334*^9}, {3.6515454366756525`*^9, 
   3.6515454403408623`*^9}, {3.651714505296322*^9, 3.6517145410573673`*^9}, 
   3.6517145888090982`*^9, {3.6517146206869216`*^9, 3.6517146892808447`*^9}, {
   3.651714868225834*^9, 3.6517148800265093`*^9}, {3.6517149756989813`*^9, 
   3.6517149910338583`*^9}, {3.651715045239959*^9, 3.6517150552855334`*^9}, {
   3.651715090943573*^9, 3.6517150940977535`*^9}, {3.6517151345130653`*^9, 
   3.6517151976006737`*^9}, 3.6517182488935413`*^9, {3.651719543344903*^9, 
   3.6517195707758427`*^9}, {3.651719906766575*^9, 3.6517199350325108`*^9}, {
   3.651719980415985*^9, 3.6517200136424065`*^9}, {3.6517206099103804`*^9, 
   3.6517206118432884`*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1664, 915},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 96, 1, 90, "Title"],
Cell[678, 25, 1378, 25, 182, "Text"],
Cell[2059, 52, 137, 3, 47, "Input"],
Cell[CellGroupData[{
Cell[2221, 59, 107, 1, 49, "Subtitle"],
Cell[2331, 62, 148376, 3450, 11650, "Input"],
Cell[150710, 3514, 271, 9, 10, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
